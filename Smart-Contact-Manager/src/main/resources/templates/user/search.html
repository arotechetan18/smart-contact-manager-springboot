<!DOCTYPE html>
<html lang="en"
      th:replace="~{base::parent(~{::#content},~{::title},~{::script},~{::navbar})}">

<head>
    <title>Search Contact</title>
</head>

<body>

<div id="content" class="p-6">

    <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-6">
        Search Results
    </h1>

    <div class="w-full">

        <div class="relative overflow-x-auto shadow-md sm:rounded-lg">

            <!-- SEARCH FORM -->
            <form th:object="${contactSearchForm}"
                  th-action="@{/user/contacts/search}"
                  method="get">

                <div class="flex items-center gap-3 pb-4">

                    <!-- Dropdown -->
                    <div class="w-40">
                        <select th:field="*{field}"
                                class="w-full bg-gray-50 border border-gray-300 text-sm rounded-lg p-2
                                dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <option value="">Select field</option>
                            <option value="name">Name</option>
                            <option value="phone">Phone</option>
                            <option value="email">Email</option>
                        </select>
                    </div>

                    <!-- Search Input -->
                    <div class="relative w-72">
                        <input th:field="*{value}"
                               type="text"
                               placeholder="Search contacts"
                               class="block w-full p-2 text-sm border border-gray-300 rounded-lg
                               dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>

                    <!-- Button -->
                    <button type="submit"
                            class="px-4 py-2 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700">
                        Search
                    </button>

                </div>
            </form>

            <!-- TABLE -->
            <div class="overflow-x-auto">

                <table class="min-w-[950px] w-full text-sm text-left text-gray-500 dark:text-gray-400">

                    <thead class="text-xs uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                    <tr>
                        <th class="px-6 py-3">Name</th>
                        <th class="px-6 py-3">Phone</th>
                        <th class="px-6 py-3">Links</th>
                        <th class="px-6 py-3 w-40">Action</th>
                    </tr>
                    </thead>

                    <tbody>

                    <tr th:each="c : ${pageContact.content}"
                        th:object="${c}"
                        class="bg-white border-b hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-700">

                        <!-- NAME -->
                        <td class="px-6 py-4 min-w-[280px]">
                            <div class="flex items-center gap-3">
                                <img class="w-10 h-10 rounded-full object-cover"
                                     th:src="@{*{picture}}"
                                     onerror="this.src='https://via.placeholder.com/40'"
                                     alt="profile">

                                <div>
                                    <div class="font-semibold text-gray-900 dark:text-white"
                                         th:text="*{name}"></div>
                                    <div class="text-sm text-gray-500"
                                         th:text="*{email}"></div>
                                </div>
                            </div>
                        </td>

                        <!-- PHONE -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span th:text="*{phoneNumber}"></span>
                        </td>

                        <!-- LINKS -->
                        <td class="px-6 py-4">
                            <div class="flex items-center gap-4">

                                <div th:if="*{favourite}"
                                     class="h-2.5 w-2.5 rounded-full bg-green-400"></div>

                                <a th:href="@{*{websiteLink}}" target="_blank">
                                    <i class="fa-solid fa-link"></i>
                                </a>

                                <a th:href="@{*{linkedInLink}}" target="_blank">
                                    <i class="fa-brands fa-linkedin"></i>
                                </a>

                            </div>
                        </td>

                        <!-- ACTION -->
                        <!-- Action buttton -->
                                    <td class="px-6 py-4">
                                        <div class="flex items-center gap-4 text-lg">
                                            <i class="fa-solid fa-trash cursor-pointer hover:text-red-600"></i>
                                            <i class="fa-solid fa-pen cursor-pointer hover:text-blue-600"></i>
                                            <i class="fa-solid fa-eye cursor-pointer hover:text-green-600"></i>
                                        </div>
                                    </td>


                    </tr>

                    </tbody>

                </table>

            </div>

            <!-- PAGINATION -->
            <div class="mt-6 flex justify-center">
                <ul class="inline-flex text-sm">

                    <li th:if="${!pageContact.first}">
                        <a th:href="@{'/user/contacts/search?page=' + ${pageContact.number-1}
                        + '&size=' + ${pageContact.size}
                        + '&field=' + ${contactSearchForm.field}
                        + '&value=' + ${contactSearchForm.value}}"
                           class="px-4 py-2 border rounded-l-lg hover:bg-gray-100">
                            Previous
                        </a>
                    </li>

                    <li th:each="index : ${#numbers.sequence(0,pageContact.totalPages-1)}">
                        <a th:href="@{'/user/contacts/search?page=' + ${index}
                        + '&size=' + ${pageContact.size}
                        + '&field=' + ${contactSearchForm.field}
                        + '&value=' + ${contactSearchForm.value}}"
                           th:class="${index == pageContact.number} ?
                           'px-4 py-2 border bg-blue-500 text-white' :
                           'px-4 py-2 border hover:bg-gray-100'">
                            <span th:text="${index + 1}"></span>
                        </a>
                    </li>

                    <li th:if="${!pageContact.last}">
                        <a th:href="@{'/user/contacts/search?page=' + ${pageContact.number+1}
                        + '&size=' + ${pageContact.size}
                        + '&field=' + ${contactSearchForm.field}
                        + '&value=' + ${contactSearchForm.value}}"
                           class="px-4 py-2 border rounded-r-lg hover:bg-gray-100">
                            Next
                        </a>
                    </li>

                </ul>
            </div>

        </div>
    </div>

</div>

<script>
    console.log("Search page loaded");
</script>

</body>
</html>